---
phase: 10-pwa-icons
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - public/icons/icon-72x72.png
  - public/icons/icon-96x96.png
  - public/icons/icon-128x128.png
  - public/icons/icon-144x144.png
  - public/icons/icon-152x152.png
  - public/icons/icon-192x192.png
  - public/icons/icon-384x384.png
  - public/icons/icon-512x512.png
  - public/icons/apple-touch-icon.png
  - public/manifest.json
  - src/app/layout.tsx
autonomous: true
must_haves:
  truths:
    - "PWA manifest loads without 404 errors in browser console"
    - "Browser 'Install app' option appears on Android Chrome"
    - "iOS Safari 'Add to Home Screen' shows HabitStreak icon"
  artifacts:
    - path: "public/icons/icon-192x192.png"
      provides: "Android PWA install icon"
      min_lines: null
    - path: "public/icons/icon-512x512.png"
      provides: "PWA splash screen icon"
      min_lines: null
    - path: "public/icons/apple-touch-icon.png"
      provides: "iOS home screen bookmark icon (180x180)"
      min_lines: null
    - path: "public/manifest.json"
      provides: "PWA manifest with valid icon references"
      contains: "icon-192x192.png"
  key_links:
    - from: "public/manifest.json"
      to: "public/icons/*.png"
      via: "icons array src paths"
      pattern: "/icons/icon-.*\\.png"
    - from: "src/app/layout.tsx"
      to: "public/icons/apple-touch-icon.png"
      via: "metadata.icons.apple"
      pattern: "apple.*apple-touch-icon"
---

<objective>
Generate complete PWA icon set from existing favicon.svg to fix manifest 404 errors and enable PWA installation.

Purpose: Users currently see 404 errors in console for missing icons, and the app cannot be installed as a PWA. This blocks the "First Impressions" milestone goal.

Output: All PWA icons generated as PNG files, manifest updated with correct purposes, layout.tsx updated with correct apple touch icon path.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md

Source files:
@public/favicon.svg - 64x64 SVG with blue circle and white checkmark (source for icon generation)
@public/manifest.json - PWA manifest referencing missing icons
@src/app/layout.tsx - Next.js metadata with icon references
</context>

<tasks>

<task type="auto">
  <name>Task 1: Generate PWA icon set from favicon.svg</name>
  <files>
    public/icons/icon-72x72.png,
    public/icons/icon-96x96.png,
    public/icons/icon-128x128.png,
    public/icons/icon-144x144.png,
    public/icons/icon-152x152.png,
    public/icons/icon-192x192.png,
    public/icons/icon-384x384.png,
    public/icons/icon-512x512.png,
    public/icons/apple-touch-icon.png
  </files>
  <action>
    Use ImageMagick to convert favicon.svg to all required PNG sizes.

    1. First create a high-quality 512x512 base PNG from the SVG:
       ```bash
       convert -background none -density 384 public/favicon.svg -resize 512x512 public/icons/icon-512x512.png
       ```
       (Use high density for crisp rendering, then resize)

    2. Generate all other sizes from the 512x512:
       ```bash
       convert public/icons/icon-512x512.png -resize 384x384 public/icons/icon-384x384.png
       convert public/icons/icon-512x512.png -resize 192x192 public/icons/icon-192x192.png
       convert public/icons/icon-512x512.png -resize 180x180 public/icons/apple-touch-icon.png
       convert public/icons/icon-512x512.png -resize 152x152 public/icons/icon-152x152.png
       convert public/icons/icon-512x512.png -resize 144x144 public/icons/icon-144x144.png
       convert public/icons/icon-512x512.png -resize 128x128 public/icons/icon-128x128.png
       convert public/icons/icon-96x96.png public/icons/icon-512x512.png -resize 96x96 public/icons/icon-96x96.png
       convert public/icons/icon-512x512.png -resize 72x72 public/icons/icon-72x72.png
       ```

    3. Delete the README.md from icons directory (no longer needed):
       ```bash
       rm public/icons/README.md
       ```

    Note: Use `-background none` only for the initial SVG conversion to preserve transparency.
  </action>
  <verify>
    ls -la public/icons/*.png | wc -l should show 9 files.
    file public/icons/icon-192x192.png should show "PNG image data".
    Visually inspect icon-512x512.png to confirm blue circle with white checkmark.
  </verify>
  <done>All 9 PNG icons exist in public/icons/ at correct sizes (72, 96, 128, 144, 152, 180, 192, 384, 512)</done>
</task>

<task type="auto">
  <name>Task 2: Update manifest.json icon purposes</name>
  <files>public/manifest.json</files>
  <action>
    Update manifest.json to fix icon purposes per PWA best practices:

    1. Change "purpose": "any maskable" to "purpose": "any" for all icons.

       Why: Combining "any" and "maskable" in a single icon entry is problematic.
       The icon design (circle with checkmark) is NOT maskable-safe - a maskable icon
       needs the content centered in a "safe zone" (inner 80% circle). Our icon fills
       the full canvas and would be clipped incorrectly on Android adaptive icons.

       For v1.3, we use "any" purpose which works for all platforms. Maskable icons
       are deferred to v2 (PWA-V2-01 in REQUIREMENTS.md).

    2. Verify all icon paths match the generated files.

    The manifest should keep all 8 sizes (72, 96, 128, 144, 152, 192, 384, 512).
  </action>
  <verify>
    cat public/manifest.json | grep '"purpose"' should show only "any" values.
    JSON should be valid: node -e "require('./public/manifest.json')"
  </verify>
  <done>All icon entries have purpose: "any" (not "any maskable")</done>
</task>

<task type="auto">
  <name>Task 3: Update layout.tsx apple touch icon path</name>
  <files>src/app/layout.tsx</files>
  <action>
    Update the apple icon path in metadata to use the correct 180x180 apple-touch-icon:

    Change:
    ```typescript
    icons: {
      icon: '/favicon.svg',
      apple: '/icons/icon-192x192.png',
    },
    ```

    To:
    ```typescript
    icons: {
      icon: '/favicon.svg',
      apple: '/icons/apple-touch-icon.png',
    },
    ```

    Why: Apple recommends 180x180 for touch icons. We generated apple-touch-icon.png at
    this size specifically for iOS. The naming convention "apple-touch-icon.png" is also
    the standard that iOS looks for automatically.
  </action>
  <verify>
    grep -n "apple-touch-icon" src/app/layout.tsx should show the updated path.
    npm run build should complete without errors.
  </verify>
  <done>layout.tsx references /icons/apple-touch-icon.png for iOS</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] All 9 PNG files exist in public/icons/ (ls public/icons/*.png | wc -l = 9)
- [ ] icon-512x512.png is valid PNG (file public/icons/icon-512x512.png)
- [ ] manifest.json is valid JSON (node -e "require('./public/manifest.json')")
- [ ] manifest.json icons have purpose: "any" (grep "purpose" public/manifest.json)
- [ ] layout.tsx references apple-touch-icon.png (grep apple-touch-icon src/app/layout.tsx)
- [ ] npm run build completes without errors
- [ ] Dev server loads without icon 404s in console (npm run dev, check Network tab)
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No 404 errors for icon files in browser console
- PWA manifest loads correctly
</success_criteria>

<output>
After completion, create `.planning/phases/10-pwa-icons/10-01-SUMMARY.md`
</output>
