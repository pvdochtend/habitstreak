---
phase: 05-polish-consistency
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/backgrounds/animated-background.tsx
  - src/app/globals.css
  - src/app/(main)/layout.tsx
autonomous: true

must_haves:
  truths:
    - "User sees subtle animated gradient orbs floating behind content"
    - "Background colors match the current theme (blue/pink)"
    - "Background respects dark mode (adjusted opacity)"
    - "Background stops animating when prefers-reduced-motion is enabled"
  artifacts:
    - path: "src/components/backgrounds/animated-background.tsx"
      provides: "Theme-aware animated orb background component"
      min_lines: 30
      exports: ["AnimatedBackground"]
    - path: "src/app/globals.css"
      provides: "Float animation keyframes"
      contains: "@keyframes floatSlow"
    - path: "src/app/(main)/layout.tsx"
      provides: "Layout with background integration"
      contains: "AnimatedBackground"
  key_links:
    - from: "animated-background.tsx"
      to: "useTheme"
      via: "theme context hook"
      pattern: "useTheme"
    - from: "animated-background.tsx"
      to: "layout.tsx"
      via: "component import"
      pattern: "AnimatedBackground"
    - from: "globals.css"
      to: "prefers-reduced-motion"
      via: "media query"
      pattern: "prefers-reduced-motion.*animate-float"
---

<objective>
Implement dynamic animated backgrounds using CSS floating gradient orbs.

Purpose: Deliver VISUAL-02 requirement - subtle animated backgrounds that enhance the glassmorphism aesthetic without distracting from content. Pure CSS solution with zero new dependencies.

Output: AnimatedBackground component integrated into main layout, with theme-aware colors and full accessibility support.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-polish-consistency/05-RESEARCH.md

@src/app/(main)/layout.tsx
@src/app/globals.css
@src/contexts/theme-context.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add floating orb keyframe animations to globals.css</name>
  <files>src/app/globals.css</files>
  <action>
Add three floating orb keyframe animations with different timing:

1. `@keyframes floatSlow` (25s cycle) - Large, gentle movement with slight scale
2. `@keyframes floatMedium` (18s cycle) - Medium movement, different pattern
3. `@keyframes floatFast` (12s cycle) - Smaller, faster movement

Add corresponding utility classes:
- `.animate-float-slow`
- `.animate-float-medium`
- `.animate-float-fast`

Add these keyframes in the existing animation section (after PHASE 4: STREAK ANIMATIONS).

CRITICAL: Add prefers-reduced-motion support - all float animations MUST be disabled when reduced motion is preferred. Add to the existing @media (prefers-reduced-motion: reduce) block.

Animation patterns (from research):
- Only animate transform (translate + scale) - GPU accelerated
- Use ease-in-out timing for organic feel
- Keep movements subtle (20-40px range)
- Scale variations small (0.92-1.1 range)
  </action>
  <verify>Grep for "floatSlow" in globals.css, verify prefers-reduced-motion block includes float animations</verify>
  <done>Three float keyframes defined with utility classes and reduced motion support</done>
</task>

<task type="auto">
  <name>Task 2: Create AnimatedBackground component</name>
  <files>src/components/backgrounds/animated-background.tsx</files>
  <action>
Create theme-aware animated background component:

1. Create directory: `src/components/backgrounds/`
2. Create `animated-background.tsx` as a Client Component ('use client')

Component requirements:
- Use `useTheme()` hook to get colorScheme and darkMode
- Render 3 gradient orbs with:
  - Fixed positioning (`fixed inset-0 -z-10 overflow-hidden`)
  - `aria-hidden="true"` for accessibility
  - `pointer-events-none` to not interfere with clicks
- Theme-aware colors:
  - Blue theme: `bg-blue-400`, `bg-indigo-400`, `bg-cyan-400`
  - Pink theme: `bg-pink-400`, `bg-fuchsia-400`, `bg-rose-400`
- Opacity adjustments:
  - Light mode: 20-30% opacity
  - Dark mode: 15-25% opacity (slightly lower to avoid washing out)
- Each orb uses different:
  - Position (top-right, left-center, bottom-right)
  - Size (h-80 w-80, h-64 w-64, h-48 w-48)
  - Blur (blur-3xl or blur-2xl)
  - Animation class (float-slow, float-medium, float-fast)

DO NOT:
- Use JavaScript for position animation (CSS keyframes only)
- Use more than 3-4 orbs (performance)
- Use mouse-following effects (not mobile friendly)
  </action>
  <verify>File exists at src/components/backgrounds/animated-background.tsx, contains useTheme import and three orb divs</verify>
  <done>AnimatedBackground component renders theme-aware floating orbs</done>
</task>

<task type="auto">
  <name>Task 3: Integrate background into main layout</name>
  <files>src/app/(main)/layout.tsx</files>
  <action>
Add AnimatedBackground to the main layout:

1. Import AnimatedBackground component
2. Add as FIRST child inside the container div, before main content
3. Add `relative z-10` to the main element to ensure content stays above background

Layout structure after change:
```tsx
<div className="min-h-screen bg-background">
  <AnimatedBackground />
  <main className="pb-20 container max-w-2xl mx-auto relative z-10">{children}</main>
  <BottomNav />
</div>
```

DO NOT add background to auth layout - only authenticated (main) pages should have it.
  </action>
  <verify>npm run build succeeds, grep layout.tsx for AnimatedBackground import</verify>
  <done>AnimatedBackground renders on all main pages behind content</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run lint` passes
- [ ] Float animations defined in globals.css
- [ ] AnimatedBackground component exists and exports correctly
- [ ] Layout imports and renders AnimatedBackground
- [ ] Reduced motion media query includes float animations
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors
- Background visible on authenticated pages
- Background respects theme (blue/pink)
- Background respects dark mode
- Background respects prefers-reduced-motion
</success_criteria>

<output>
After completion, create `.planning/phases/05-polish-consistency/05-01-SUMMARY.md`
</output>
