---
phase: 03-task-completion-experience
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/tasks/today-task-item.tsx
  - src/components/ui/animated-checkmark.tsx
  - src/app/globals.css
autonomous: true

must_haves:
  truths:
    - "User sees checkmark draw-on animation when completing a task"
    - "User sees checkbox fill with color from center outward"
    - "User sees task row background color transition on completion"
  artifacts:
    - path: "src/components/ui/animated-checkmark.tsx"
      provides: "SVG checkmark with stroke-dasharray draw animation"
      min_lines: 30
    - path: "src/app/globals.css"
      provides: "Draw-on keyframe animation and color fill animation"
      contains: "stroke-dasharray"
  key_links:
    - from: "animated-checkmark.tsx"
      to: "today-task-item.tsx"
      via: "AnimatedCheckmark component import and usage"
      pattern: "AnimatedCheckmark"
    - from: "globals.css"
      to: "animated-checkmark.tsx"
      via: "animate-draw-checkmark class usage"
      pattern: "animate-draw-checkmark"
---

<objective>
Implement the visual checkmark draw animation and color fill effect for task completion.

Purpose: Make task completion feel satisfying with a smooth checkmark that draws itself and color that fills the checkbox.
Output: AnimatedCheckmark component with SVG stroke animation, enhanced checkbox fill animation.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-animation-foundation/02-01-SUMMARY.md
@.planning/phases/02-animation-foundation/02-03-SUMMARY.md

Relevant source files:
@src/components/tasks/today-task-item.tsx
@src/app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AnimatedCheckmark component with SVG stroke animation</name>
  <files>src/components/ui/animated-checkmark.tsx</files>
  <action>
Create a new React component that renders an SVG checkmark with draw-on animation:

1. SVG structure:
   - Viewbox: 0 0 24 24
   - Single polyline for the check shape: points="4 12 9 17 20 6" or similar
   - Stroke-linecap: round, stroke-linejoin: round
   - Stroke color: currentColor (inherits from parent)

2. Animation using stroke-dasharray/stroke-dashoffset:
   - Calculate path length (~30 for a checkmark)
   - Initial state: stroke-dasharray: 30, stroke-dashoffset: 30 (invisible)
   - Animated state: stroke-dashoffset: 0 (fully drawn)
   - Use CSS animation class `animate-draw-checkmark`

3. Props interface:
   - `isChecked: boolean` - controls animation trigger
   - `className?: string` - for additional styling
   - `size?: number` - default 16

4. Animation timing:
   - Duration: 300-400ms
   - Easing: ease-out
   - Delay: 50ms (let checkbox fill start first)

DO NOT use Framer Motion or external animation libraries - pure CSS animation with stroke-dashoffset.
  </action>
  <verify>
- File exists at src/components/ui/animated-checkmark.tsx
- Component exports AnimatedCheckmark
- TypeScript compiles without errors
  </verify>
  <done>AnimatedCheckmark component created with SVG stroke draw animation</done>
</task>

<task type="auto">
  <name>Task 2: Add CSS keyframes for checkmark draw and color fill</name>
  <files>src/app/globals.css</files>
  <action>
Add new keyframe animations to globals.css in the custom animations section:

1. Checkmark draw animation:
```css
@keyframes drawCheckmark {
  from {
    stroke-dashoffset: 30;
  }
  to {
    stroke-dashoffset: 0;
  }
}

.animate-draw-checkmark {
  animation: drawCheckmark 0.35s ease-out forwards;
  animation-delay: 0.05s;
}
```

2. Enhanced checkbox fill animation (color fills from center):
```css
@keyframes checkboxFill {
  0% {
    transform: scale(0);
    opacity: 0;
  }
  50% {
    transform: scale(1.15);
    opacity: 1;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.animate-checkbox-fill {
  animation: checkboxFill 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}
```

3. Task row completion background transition (subtle color spread):
```css
@keyframes taskComplete {
  0% {
    background-color: hsl(var(--card));
  }
  50% {
    background-color: hsl(var(--primary) / 0.12);
  }
  100% {
    background-color: hsl(var(--primary) / 0.05);
  }
}

.animate-task-complete {
  animation: taskComplete 0.5s ease-out forwards;
}
```

4. Update the reduced-motion section to include the new classes:
   Add `.animate-draw-checkmark, .animate-checkbox-fill, .animate-task-complete` to the disabled animations list.
  </action>
  <verify>
- npm run build succeeds
- New keyframes exist in globals.css
- Reduced motion section updated
  </verify>
  <done>CSS animations for checkmark draw, checkbox fill, and task complete added</done>
</task>

<task type="auto">
  <name>Task 3: Integrate AnimatedCheckmark into TodayTaskItem</name>
  <files>src/components/tasks/today-task-item.tsx</files>
  <action>
Update the TodayTaskItem component to use the new animations:

1. Import the new component:
   `import { AnimatedCheckmark } from '@/components/ui/animated-checkmark'`

2. Replace the existing Check icon inside the checkbox div with AnimatedCheckmark:
   - Current: `<Check className="h-4 w-4 text-primary-foreground animate-checkmark" />`
   - New: `<AnimatedCheckmark isChecked={task.isCompleted} className="text-primary-foreground" size={16} />`

3. Update the checkbox container div:
   - Add `animate-checkbox-fill` class when task.isCompleted changes to true
   - Keep existing scale-110 on completion
   - The animation should only trigger on the transition from incomplete to complete

4. Add `animate-task-complete` class to the button element when `isAnimating` is true:
   - This triggers the background color fill animation
   - Remove or adjust the existing `animate-celebrate` if it conflicts

5. Ensure animation states work correctly:
   - isAnimating triggers both button background AND checkbox fill
   - The sequence: checkbox fills (0-300ms) → checkmark draws (50-400ms) → background settles (0-500ms)

6. Keep existing CelebrationEffect integration - it will be enhanced in Plan 03.
  </action>
  <verify>
- npm run build succeeds
- npm run lint passes
- TodayTaskItem imports AnimatedCheckmark
- New animation classes applied conditionally
  </verify>
  <done>TodayTaskItem uses AnimatedCheckmark and new CSS animations for task completion</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run lint` passes without errors
- [ ] AnimatedCheckmark component exists and exports correctly
- [ ] New CSS keyframes present in globals.css
- [ ] Reduced-motion section updated with new animation classes
- [ ] TodayTaskItem integrates new checkmark component
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Checkmark draws with stroke animation when task completes
- Checkbox fills with spring animation
- Task row shows subtle color transition
- Animations respect prefers-reduced-motion
</success_criteria>

<output>
After completion, create `.planning/phases/03-task-completion-experience/03-01-SUMMARY.md`
</output>
