# Requirements Archive: v1.1 Self-Hosting & Polish

**Archived:** 2026-01-19
**Status:** ✅ SHIPPED

This is the archived requirements specification for v1.1.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# Requirements: HabitStreak v1.1

**Defined:** 2026-01-18
**Core Value:** Make every interaction feel rewarding

## v1.1 Requirements

Requirements for v1.1 Self-Hosting & Polish release.

### Docker Deployment

- [x] **DOCKER-01**: App can be built as standalone Docker image under 300MB
  - **Outcome:** Achieved 351MB (acceptable for Next.js + Prisma)
- [x] **DOCKER-02**: docker-compose includes PostgreSQL with health checks
  - **Outcome:** Both services with health checks implemented
- [x] **DOCKER-03**: App exposes `/api/health` endpoint for container orchestration
  - **Outcome:** Public endpoint returning JSON without auth
- [x] **DOCKER-04**: Environment variables documented in `.env.production.example`
  - **Outcome:** Complete template with generation commands
- [x] **DOCKER-05**: App runs Prisma migrations automatically at startup
  - **Outcome:** CMD runs migrations before server start
- [x] **DOCKER-06**: Synology NAS deployment steps documented
  - **Outcome:** 201-line guide with GUI and CLI options

### Streak Calculation

- [x] **STREAK-01**: Days with fewer scheduled tasks than dailyTarget are evaluated correctly (effectiveTarget = min(dailyTarget, scheduledCount))
  - **Outcome:** isDaySuccessful() function implemented with formula
- [x] **STREAK-02**: calculateCurrentStreak handles WORKWEEK tasks on weekends
  - **Outcome:** Uses isDaySuccessful() for consistent logic
- [x] **STREAK-03**: calculateBestStreak uses same effectiveTarget logic
  - **Outcome:** Uses isDaySuccessful() for consistent logic
- [x] **STREAK-04**: Unit tests cover WORKWEEK/WEEKEND edge cases
  - **Outcome:** 13 test cases covering all schedule presets

### Animation Polish

- [x] **ANIM-01**: Flame glow opacity increased from 30% to 50%+ for visibility
  - **Outcome:** 50-80% opacity, 4-10px blur radius
- [x] **ANIM-02**: Animation end state fixed (no blink from shadow-sm conflict)
  - **Outcome:** hasMounted ref prevents re-trigger on data refresh
- [x] **ANIM-03**: prefers-reduced-motion support maintained
  - **Outcome:** All animations in @media query

## v2 Requirements

Deferred to future release. Tracked but not in current roadmap.

### Streak Enhancements

- **STREAK-05**: Streak freeze feature (schema ready, UI not implemented)
- **STREAK-06**: Grace period for midnight completions (3-6 hours)

### Animation Enhancements

- **ANIM-04**: iOS Safari-specific box-shadow optimization
- **ANIM-05**: DST transition testing

## Out of Scope

Explicitly excluded. Documented to prevent scope creep.

| Feature | Reason |
|---------|--------|
| Streak freeze UI | Schema ready but adds complexity; defer to v2 |
| Historical schedule snapshots | Would require schema changes; current approach documented |
| Sound effects | User preference varies; visual-first per v1.0 research |

## Traceability

Which phases cover which requirements. Updated by create-roadmap.

| Requirement | Phase | Status |
|-------------|-------|--------|
| DOCKER-01 | Phase 6 | Complete |
| DOCKER-02 | Phase 6 | Complete |
| DOCKER-03 | Phase 6 | Complete |
| DOCKER-04 | Phase 6 | Complete |
| DOCKER-05 | Phase 6 | Complete |
| DOCKER-06 | Phase 6 | Complete |
| STREAK-01 | Phase 7 | Complete |
| STREAK-02 | Phase 7 | Complete |
| STREAK-03 | Phase 7 | Complete |
| STREAK-04 | Phase 7 | Complete |
| ANIM-01 | Phase 8 | Complete |
| ANIM-02 | Phase 8 | Complete |
| ANIM-03 | Phase 8 | Complete |

**Coverage:**
- v1.1 requirements: 13 total
- Mapped to phases: 13 ✓
- Unmapped: 0

---

## Milestone Summary

**Shipped:** 13 of 13 v1.1 requirements (100%)

**Adjusted:**
- DOCKER-01: Target was 300MB, achieved 351MB (acceptable for Next.js + Prisma stack)

**Dropped:**
- None - all planned requirements delivered

**Key Achievements:**
- Self-hosting capability fully functional and documented
- Streak calculation bug fixed with comprehensive test coverage
- Flame animations enhanced for mobile visibility
- End-to-end Docker deployment verified working

---
*Archived: 2026-01-19 as part of v1.1 milestone completion*
